-- ‡πÇ‡∏´‡∏•‡∏î WindUI
local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Camera = workspace.CurrentCamera
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Debris = game:GetService("Debris")

local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")
local Mouse = LocalPlayer:GetMouse()

local Window = WindUI:CreateWindow({
    Title = "Yomo HUB üßë‚Äçüíª | v2  | ",
    Icon = "menu",
    Author = "https://discord.gg/xWW3jhKM",
    Folder = "KungHubkFolder",
    Size = UDim2.fromOffset(400, 200),
    Theme = "Dark",
    Transparent = true,
    Resizable = true,
})

local button = Window:EditOpenButton({
    Title = "Open Menu",
    Icon = "apple",
    CornerRadius = UDim.new(0,50),
    StrokeThickness = 2,
    Color = ColorSequence.new(Color3.fromHSV(0, 1, 1), Color3.fromHSV(0.1, 1, 1)),
    OnlyMobile = false,
    Enabled = true,
    Draggable = false,
})

---------------------------------
-- Silent Aim Tab & Logic -----
---------------------------------
local Tab = Window:Tab({Title = "Silent Aim", Icon = "crosshair"})
local SilentAimEnabled = false
local NoRecoilEnabled = true
local FOVRadius = 120
local CurrentTarget = nil

local ConstantPingTime = 0.2 -- 200ms
local ConstantBulletSpeed = 2000

local SilentFOVCircle = Drawing.new("Circle")
SilentFOVCircle.Color = Color3.fromRGB(255, 255, 0)
SilentFOVCircle.Thickness = 1
SilentFOVCircle.NumSides = 64
SilentFOVCircle.Filled = false
SilentFOVCircle.Transparency = 1
SilentFOVCircle.Radius = FOVRadius
SilentFOVCircle.Visible = false

local Tracer = Drawing.new("Line")
Tracer.Thickness = 1
Tracer.Color = Color3.fromRGB(0, 255, 255)
Tracer.Transparency = 1
Tracer.Visible = false

local function isBehindWall(startPos, endPos)
    if (startPos - endPos).Magnitude < 2 then return false end
    local ignore = {LocalPlayer.Character}
    if CurrentTarget and CurrentTarget.Character then
        table.insert(ignore, CurrentTarget.Character)
    end
    local params = RaycastParams.new()
    params.FilterDescendantsInstances = ignore
    params.FilterType = Enum.RaycastFilterType.Blacklist
    params.IgnoreWater = true

    local direction = (endPos - startPos).Unit
    local distance = (endPos - startPos).Magnitude
    local rayResult = workspace:Raycast(startPos, direction * distance, params)

    if rayResult and rayResult.Instance then
        if not (rayResult.Instance:IsDescendantOf(CurrentTarget.Character)
        or rayResult.Instance:IsDescendantOf(LocalPlayer.Character)) then
            return true
        end
    end
    return false
end

local function predictWallbangPosition_New(head, hrp)
    local velocity = hrp and hrp.Velocity or Vector3.zero
    local origin = Camera.CFrame.Position
    local distance = (head.Position - origin).Magnitude
    local bulletTime = distance / ConstantBulletSpeed
    local predictTime = bulletTime + ConstantPingTime
    return head.Position + (velocity * predictTime)
end

local function getClosestTarget()
    local closest, shortestDistance = nil, math.huge
    local center = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)

    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Head") then
            local head = player.Character.Head
            local pos, onScreen = Camera:WorldToViewportPoint(head.Position)
            if onScreen then
                local screenPos = Vector2.new(pos.X, pos.Y)
                if (screenPos - center).Magnitude <= FOVRadius then
                    local toTarget = (head.Position - Camera.CFrame.Position).Unit
                    if Camera.CFrame.LookVector:Dot(toTarget) > 0.5 then
                        local distance3D = (head.Position - LocalPlayer.Character.Head.Position).Magnitude
                        if distance3D < shortestDistance then
                            shortestDistance = distance3D
                            closest = player
                        end
                    end
                end
            end
        end
    end
    return closest
end

RunService.RenderStepped:Connect(function()
    SilentFOVCircle.Visible = SilentAimEnabled
    SilentFOVCircle.Position = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)

    if SilentAimEnabled then
        CurrentTarget = getClosestTarget()
    else
        CurrentTarget = nil
    end

    if CurrentTarget and CurrentTarget.Character then
        local head = CurrentTarget.Character:FindFirstChild("Head")
        if head then
            local myHead = LocalPlayer.Character:FindFirstChild("Head")
            if myHead then
                local a, ascr = Camera:WorldToViewportPoint(myHead.Position)
                local b, bscr = Camera:WorldToViewportPoint(head.Position)
                if ascr and bscr then
                    Tracer.From = Vector2.new(a.X, a.Y)
                    Tracer.To = Vector2.new(b.X, b.Y)
                    Tracer.Visible = true
                else
                    Tracer.Visible = false
                end
            end
        end
    else
        Tracer.Visible = false
    end
end)

local function doRecoilGunMods()
    while task.wait(1) do
        for _, tool in pairs(LocalPlayer.Backpack:GetChildren()) do
            if tool:IsA("Tool") then
                if tool:FindFirstChild("Recoil") then tool.Recoil.Value = 0 end
                if tool:GetAttribute("Recoil") then tool:SetAttribute("Recoil", 0) end
            end
        end
        for _, tool in pairs(LocalPlayer.Character:GetChildren()) do
            if tool:IsA("Tool") then
                if tool:FindFirstChild("Recoil") then tool.Recoil.Value = 0 end
                if tool:GetAttribute("Recoil") then tool:SetAttribute("Recoil", 0) end
            end
        end
    end
end
spawn(doRecoilGunMods)

local Remote = ReplicatedStorage.Remotes.Send
local oldFire = hookfunction(Remote.FireServer, function(self, ...)
    if self ~= Remote then return oldFire(self, ...) end
    local args = {...}

    if SilentAimEnabled and args[2] == "shoot_gun" and CurrentTarget then
        local head = CurrentTarget.Character:FindFirstChild("Head")
        local hrp = CurrentTarget.Character:FindFirstChild("HumanoidRootPart")
        if head and hrp then
            local myPos = LocalPlayer.Character.Head.Position
            local wall = isBehindWall(myPos, head.Position)
            local aimPos = wall and predictWallbangPosition_New(head, hrp) or head.Position

            args[4] = CFrame.new(math.huge, math.huge, math.huge)
            args[5] = {
                [1] = {
                    [1] = {
                        ["Instance"] = head,
                        ["Normal"] = Vector3.new(0,1,0),
                        ["Position"] = aimPos,
                        ["Wallbang"] = wall
                    }
                }
            }
        end
    end

    return oldFire(self, unpack(args))
end)

Tab:Toggle({
    Title = "Silent Aim",
    Default = false,
    Callback = function(v) SilentAimEnabled = v end
})

Tab:Toggle({
    Title = "No Recoil",
    Default = true,
    Callback = function(v) NoRecoilEnabled = v end
})

Tab:Slider({
    Title = "FOV:",
    Step = 1,
    Value = {Min = 20, Max = 500, Default = 120},
    Callback = function(v) FOVRadius = v end
})

-------------------------------
-- ESP Tab & Logic ------------
-------------------------------
local Tab_ESP = Window:Tab({Title = "ESP", Icon = "eye"})

local boxESPEnabled = false
local nameESPEnabled = false
local itemESPEnabled = false
local itemDropESPEnabled = false
local espPlayers = {}

Tab_ESP:Toggle({
    Title = "Box ESP",
    Default = false,
    Callback = function(v) boxESPEnabled = v end
})

Tab_ESP:Toggle({
    Title = "Name ESP",
    Default = false,
    Callback = function(v) nameESPEnabled = v end
})

Tab_ESP:Toggle({
    Title = "Inventory Viewer ESP",
    Default = false,
    Callback = function(v) itemESPEnabled = v end
})

Tab_ESP:Toggle({
    Title = "Item Drop ESP",
    Default = false,
    Callback = function(v) itemDropESPEnabled = v end
})

-- *******************************
-- Inventory Viewer (‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà + ‡∏Ñ‡∏£‡∏ö‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°)
-- *******************************
local function getPlayerInventory(player)
    local inv = {}
    -- ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å Backpack
    local backpack = player:FindFirstChildOfClass("Backpack")
    if backpack then
        for _, item in ipairs(backpack:GetChildren()) do
            if item:IsA("Tool") then
                table.insert(inv, "üéí " .. item.Name)
            end
        end
    end

    -- ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å Character (‡∏ñ‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà)
    if player.Character then
        for _, tool in ipairs(player.Character:GetChildren()) do
            if tool:IsA("Tool") then
                table.insert(inv, "‚úã " .. tool.Name)
            end
        end
    end

    -- ‡πÄ‡∏≠‡∏≤‡πÑ‡∏≠‡πÄ‡∏ó‡πá‡∏°‡∏à‡∏≤‡∏Å StarterGear/StarterPack (‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÄ‡∏Å‡∏°‡∏ô‡∏±‡πâ‡∏ô)
    for _, folderName in ipairs({"StarterGear", "StarterPack"}) do
        local folder = player:FindFirstChild(folderName)
        if folder then
            for _, tool in ipairs(folder:GetChildren()) do
                if tool:IsA("Tool") then
                    table.insert(inv, "üóÑÔ∏è " .. tool.Name)
                end
            end
        end
    end

    return inv
end

-- ********************************
-- ESP ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô (‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ä‡∏∏‡∏î!!)
-- ********************************
local function createESP(player)
    local lines = {
        top = Drawing.new("Line"),
        bottom = Drawing.new("Line"),
        left = Drawing.new("Line"),
        right = Drawing.new("Line")
    }

    local nameText = Drawing.new("Text")
    nameText.Size = 16
    nameText.Center = true
    nameText.Outline = true
    nameText.Color = Color3.fromRGB(255,0,0)

    local itemText = Drawing.new("Text")
    itemText.Size = 14
    itemText.Center = false
    itemText.Outline = true
    itemText.Color = Color3.fromRGB(0,255,128)

    for _, line in pairs(lines) do
        line.Color = Color3.new(1,1,1)
        line.Thickness = 1
        line.Visible = false
    end
    nameText.Visible = false
    itemText.Visible = false

    local drawings = {lines.top, lines.bottom, lines.left, lines.right, nameText, itemText}

    local conn = RunService.RenderStepped:Connect(function()
        if not player.Character then
            nameText.Visible = false
            itemText.Visible = false
            for _, l in pairs(lines) do l.Visible = false end
            return
        end

        local head = player.Character:FindFirstChild("Head")
        local hrp = player.Character:FindFirstChild("HumanoidRootPart")
        if not head or not hrp then return end

        local topWorld = head.Position + Vector3.new(0,1,0)
        local bottomWorld = hrp.Position - Vector3.new(0,3.5,0)

        local top, onTop = Camera:WorldToViewportPoint(topWorld)
        local bottom, onBottom = Camera:WorldToViewportPoint(bottomWorld)

        if onTop and onBottom and top.Z > 0 then
            local height = math.abs(top.Y - bottom.Y) * 1.2
            local width = height / 1.5
            local x = top.X - width/2
            local y = top.Y - height*0.1

            local tl = Vector2.new(x,y)
            local tr = Vector2.new(x+width,y)
            local bl = Vector2.new(x,y+height)
            local br = Vector2.new(x+width,y+height)

            if boxESPEnabled then
                lines.top.From = tl; lines.top.To = tr
                lines.bottom.From = bl; lines.bottom.To = br
                lines.left.From = tl; lines.left.To = bl
                lines.right.From = tr; lines.right.To = br
                for _, l in pairs(lines) do l.Visible = true end
            else
                for _, l in pairs(lines) do l.Visible = false end
            end

            if nameESPEnabled then
                nameText.Text = player.Name
                nameText.Position = Vector2.new(top.X, y - 15)
                nameText.Visible = true
            else
                nameText.Visible = false
            end

            -- ================
            -- Inventory Viewer
            -- ================
            if itemESPEnabled then
                local items = getPlayerInventory(player)
                if #items > 0 then
                    -- ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î (‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏ñ‡∏ß) item
                    local txt = table.concat(items, "\n")
                    itemText.Text = txt
                    itemText.Position = Vector2.new(tl.X, bl.Y + 5)
                    itemText.Visible = true
                else
                    itemText.Visible = false
                end
            else
                itemText.Visible = false
            end

        else
            nameText.Visible = false
            itemText.Visible = false
            for _, l in pairs(lines) do l.Visible = false end
        end
    end)

    espPlayers[player] = {conn = conn, drawings = drawings}
end

local function loadESP()
    for _, p in ipairs(Players:GetPlayers()) do
        if p ~= LocalPlayer then createESP(p) end
    end

    Players.PlayerAdded:Connect(function(p)
        if p ~= LocalPlayer then
            p.CharacterAdded:Connect(function()
                task.wait(.2)
                createESP(p)
            end)
        end
    end)

    Players.PlayerRemoving:Connect(function(p)
        if espPlayers[p] then
            espPlayers[p].conn:Disconnect()
            for _, d in pairs(espPlayers[p].drawings) do d:Remove() end
            espPlayers[p] = nil
        end
    end)
end

loadESP()

-------------------------
-- ITEM DROP ESP
-------------------------
local dropfolder = workspace:FindFirstChild("DroppedItems")
local item_drawings = {}

local function Get2DPos(part)
    local ok, pos, on = pcall(function()
        return Camera:WorldToViewportPoint(part.Position)
    end)
    if ok then return Vector2.new(pos.X,pos.Y), pos.Z, on end
    return Vector2.new(0,0), 0, false
end

RunService.RenderStepped:Connect(function()
    if not itemDropESPEnabled then
        for _, d in pairs(item_drawings) do
            d.box.Visible = false
            d.name.Visible = false
            d.dist.Visible = false
        end
        return
    end

    if dropfolder then
        for obj, d in pairs(item_drawings) do
            if not obj or not obj.Parent then
                d.box:Remove()
                d.name:Remove()
                d.dist:Remove()
                item_drawings[obj] = nil
            end
        end

        for _, item in ipairs(dropfolder:GetChildren()) do
            if item:IsA("Model") and item:FindFirstChild("PickUpZone") then
                local esp = item_drawings[item]
                if not esp then
                    esp = {
                        box = Drawing.new("Square"),
                        name = Drawing.new("Text"),
                        dist = Drawing.new("Text")
                    }
                    esp.box.Color = Color3.new(1,1,1)
                    esp.box.Filled = false
                    esp.box.Thickness = 1

                    esp.name.Size = 15
                    esp.name.Color = Color3.new(1,1,1)
                    esp.name.Outline = true

                    esp.dist.Size = 15
                    esp.dist.Color = Color3.fromRGB(0,255,128)
                    esp.dist.Outline = true

                    item_drawings[item] = esp
                end

                local pos, depth, onScr = Get2DPos(item.PickUpZone)
                if onScr and depth > 0 then
                    local size = math.clamp(100 / depth, 15, 40)
                    esp.box.Size = Vector2.new(size, size)
                    esp.box.Position = Vector2.new(pos.X - size/2, pos.Y - size/2)
                    esp.box.Visible = true

                    esp.name.Text = item.Name
                    esp.name.Position = Vector2.new(pos.X, pos.Y - size/2 - 10)
                    esp.name.Visible = true

                    local amount = "?"
                    local gui = item:FindFirstChild("AmountBillboardGui")
                    if gui and gui:FindFirstChild("TextLabel") then
                        amount = gui.TextLabel.Text
                    end
                    esp.dist.Text = "["..amount.."]"
                    esp.dist.Position = Vector2.new(pos.X, pos.Y + size/2 + 5)
                    esp.dist.Visible = true
                else
                    esp.box.Visible = false
                    esp.name.Visible = false
                    esp.dist.Visible = false
                end
            end
        end
    end
end)